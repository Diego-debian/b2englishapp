# T0.5 Estrategia de Comentarios (Beta)

Este documento define la estrategia para permitir comentarios en las lecciones de B2English durante la fase Beta, utilizando una solución externa para minimizar el mantenimiento.

## 1. Principios de la Estrategia

1.  **External-First**: Delegar la complejidad (storage, auth, moderación) a un proveedor especializado.
2.  **Reversible**: La implementación no debe acoplarse fuertemente al core del producto. Si se decide quitar, debe ser tan simple como eliminar un componente React.
3.  **Zero Backend Maintenance**: No crear tablas, endpoints ni lógica de servidor para esto.

---

## 2. Opciones Evaluadas

### A. Sistema Propio (Descartado)
- **Pros**: Control total de UI y datos.
- **Contras**: Requiere tablas `comments`, auth extra, endpoints CRUD, UI de moderación, control de spam. **Costo de desarrollo excesivo para Beta.**

### B. Disqus (No Recomendado)
- **Pros**: Fácil integración.
- **Contras**: Invasivo con privacidad, ads obligatorios en free tier, UI pesada.

### C. Giscus (Recomendado)
- **Pros**:
    - Open Source, sin ads, sin tracking.
    - Utiliza GitHub Discussions como backend (gratis y persistente).
    - Auth delegada a GitHub (bueno para audiencia tech/dev, aceptable para público general en beta).
    - Styling adaptable via CSS.
- **Decisión**: **USAR GISCUS**.

---

## 3. Especificación Conceptual (Giscus)

### Configuración Base
- **Repository**: Un repo público dedicado (ej. `b2english-discussions`) o el mismo repo del proyecto (si es público), habilitando la feature "Discussions".
- **Mapping**: Mapear cada Lección a una Discussion.
    - Clave: `pathname` o `slug` de la lección.
    - Behavior: Al cargar la lección `slug`, Giscus busca/crea la discussion asociada.

### Auth & Moderación
- **Auth**: El usuario se loguea en el widget con su cuenta de GitHub. B2English no maneja estas credenciales.
- **Moderación**: Se realiza directamente en GitHub (borrar comments, bloquear usuarios).

---

## 4. Reglas de Integración

1.  **Scope de Visibilidad**:
    - Solo renderizar el bloque de comentarios si `Lesson.status == 'published'`.
2.  **Posicionamiento UI**:
    - Siempre al final del contenido, después de todos los `content_blocks`.
    - Contenedor aislado visualmente (ej. "Comentarios de la Comunidad").
3.  **Aislamiento Funcional**:
    - Comentar **NO** otorga XP.
    - Comentar **NO** afecta el progreso de la lección.
    - No hay interacción entre el usuario de B2English (JWT) y el usuario de Giscus (GitHub). Son identidades separadas.

---

## 5. Alcance Beta (Fuera de Scope)

Explicitamente NO se implementará:
- **Comentarios In-line**: Comentar sobre un párrafo específico.
- **Notificaciones In-App**: El usuario no sabrá si le respondieron dentro de B2English (GitHub le notifica por mail).
- **Sincronización de Cuentas**: No intentaremos vincular el `user_id` de B2English con el handle de GitHub.
- **Temas Oscuros/Claros Automáticos**: Configuración manual inicial (default system o dark).
